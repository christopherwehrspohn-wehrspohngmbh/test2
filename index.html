<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>T√ºrchen 24</title>

  <!-- Roboto (Gutschein) -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700;900&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg1:#0b1b3a;
      --bg2:#153a6b;
      --ink:#10213a;
      --gold:#f4d37a;
      --shadow: 0 18px 50px rgba(0,0,0,.28);
      --radius: 22px;
      --fit: 1;
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; margin:0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; color:#fff; }
    body{
      background:
        radial-gradient(1200px 800px at 50% 25%, rgba(255,255,255,.10), transparent 60%),
        linear-gradient(180deg,var(--bg2),var(--bg1));
      overflow:hidden;
      -webkit-tap-highlight-color: transparent;
      user-select:none;
      touch-action: manipulation;
    }

    .stage{
      position:relative;
      height:100%;
      width:100%;
      display:flex;
      align-items:center;
      justify-content:center;
      padding: 22px 18px 34px;
    }

    canvas#snow{
      position:absolute;
      inset:0;
      width:100%;
      height:100%;
      pointer-events:none;
      opacity:.9;
      z-index: 0;
    }

    canvas#confetti{
      position:absolute;
      inset:0;
      width:100%;
      height:100%;
      pointer-events:none;
      opacity:0;
      transition: opacity 250ms ease;
      z-index: 8;
    }

    .hint{
      position:absolute;
      top: max(16px, env(safe-area-inset-top));
      left:0; right:0;
      text-align:center;
      font-size:14px;
      opacity:.85;
      letter-spacing:.2px;
      padding: 0 16px;
      z-index: 9;
    }
    .hint b{ color: var(--gold); font-weight:700; }

    /* ‚ú® Twinkles */
    .twinkles{
      position:absolute;
      inset:0;
      pointer-events:none;
      opacity:.25;
      transition: opacity 400ms ease;
      background:
        radial-gradient(2px 2px at 22% 30%, rgba(255,255,255,.9), transparent 60%),
        radial-gradient(2px 2px at 70% 26%, rgba(255,255,255,.8), transparent 60%),
        radial-gradient(2px 2px at 54% 62%, rgba(255,255,255,.85), transparent 60%),
        radial-gradient(2px 2px at 82% 58%, rgba(255,255,255,.75), transparent 60%);
      animation: tw 2.6s ease-in-out infinite;
      z-index: 1;
    }
    @keyframes tw{
      0%,100%{ transform: translateY(0); opacity:.35; }
      50%{ transform: translateY(-2px); opacity:.7; }
    }
    body.state-1 .twinkles,
    body.state-2 .twinkles,
    body.state-3 .twinkles,
    body.state-4 .twinkles,
    body.state-5 .twinkles,
    body.state-6 .twinkles{ opacity:.55; }

    /* Door / Card */
    .doorWrap{
      width:min(340px, 88vw);
      aspect-ratio: 3 / 4;
      position:relative;
      perspective: 1200px;
      display:flex;
      align-items:center;
      justify-content:center;
      z-index: 2;

      transition: transform 120ms ease;
      transform: translateZ(0);
      will-change: transform;
    }

    /* ‚ú® always-on glow */
    .doorWrap::before{
      content:"";
      position:absolute;
      inset:-18px;
      border-radius: 28px;
      background: radial-gradient(circle at 50% 35%, rgba(244,211,122,.35), transparent 60%);
      filter: blur(10px);
      opacity:.55;
      z-index:-1;
      animation: glowPulse 3.2s ease-in-out infinite;
    }
    @keyframes glowPulse{
      0%,100%{ opacity:.35; transform: scale(1); }
      50%{ opacity:.7; transform: scale(1.02); }
    }

    .doorWrap.tapPop{ transform: scale(.992) translateZ(0); }

    .frame{
      position:absolute;
      inset:0;
      border-radius: var(--radius);
      background: linear-gradient(180deg, rgba(255,255,255,.09), rgba(255,255,255,.04));
      border: 1px solid rgba(255,255,255,.18);
      box-shadow: var(--shadow);
      overflow:hidden;

      /* ‚ùÑÔ∏è frosted glass */
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
    }
    .frame:before{
      content:"";
      position:absolute;
      inset:14px;
      border-radius: calc(var(--radius) - 8px);
      border: 1px dashed rgba(244,211,122,.45);
      opacity:.8;
    }

    .door{
      position:absolute;
      inset: 14px;
      border-radius: calc(var(--radius) - 8px);
      transform-origin: left center;
      transform: rotateY(0deg);
      transition: transform 900ms cubic-bezier(.2,.9,.15,1);
      background:
        radial-gradient(800px 520px at 70% 15%, rgba(255,255,255,.22), transparent 55%),
        linear-gradient(145deg, rgba(244,211,122,.25), rgba(255,255,255,.06));
      border: 1px solid rgba(255,255,255,.20);
      box-shadow: inset 0 0 0 1px rgba(0,0,0,.08);
      display:flex;
      align-items:center;
      justify-content:center;
    }
    .door .num{
      font-size: 92px;
      font-weight: 850;
      line-height: 1;
      letter-spacing: 1px;
      color: rgba(255,255,255,.92);
      text-shadow: 0 10px 24px rgba(0,0,0,.35);
    }
    .door .tag{
      position:absolute;
      bottom: 18px;
      font-size: 14px;
      opacity: .9;
      letter-spacing:.3px;
      color: rgba(255,255,255,.88);
    }
    .knob{
      position:absolute;
      width: 16px;
      height: 16px;
      right: 18px;
      top: 50%;
      transform: translateY(-50%);
      border-radius: 999px;
      background: radial-gradient(circle at 30% 30%, #fff, var(--gold));
      box-shadow: 0 6px 18px rgba(0,0,0,.25);
      opacity: .95;
    }

    /* ---------- CARD FLIP ---------- */
    .card{
      position:absolute;
      left: 20px;
      right: 20px;
      top: 22px;
      bottom: 22px;
      border-radius: 18px;
      box-shadow: 0 18px 44px rgba(0,0,0,.24);
      transform: translateX(-18px) translateY(10px);
      opacity: 0;
      transition: transform 900ms cubic-bezier(.2,.9,.15,1), opacity 500ms ease;
      overflow:hidden;
      display:block;
      perspective: 1000px;
      background: transparent;
    }

    .cardInner{
      position:absolute;
      inset:0;
      transform-style: preserve-3d;
      transform: rotateY(0deg);
      transition: transform 900ms cubic-bezier(.2,.9,.15,1);
      will-change: transform;
    }

    .cardFace{
      position:absolute;
      inset:0;
      border-radius: 18px;
      backface-visibility: hidden;
      -webkit-backface-visibility: hidden;
      overflow:hidden;
      display:flex;
      flex-direction:column;
    }

    .cardFront{
      background: linear-gradient(180deg, rgba(255,255,255,.98), rgba(255,255,255,.92));
      color: var(--ink);
    }

    /* ‚úÖ exakt dein Gutschein-CSS (integriert, unver√§ndert) */
    .cardBack{
      background:#fff;
      color:var(--ink);
      font-family:Roboto,system-ui,sans-serif;
      transform:rotateY(180deg);
      position:relative;
    }

    body.state-6 .cardInner{ transform: rotateY(180deg); }

    /* ---------- FRONT CONTENT ---------- */
    .cardHeader{
      padding: calc(18px * var(--fit)) calc(18px * var(--fit)) calc(14px * var(--fit));
      border-bottom: 1px solid rgba(16,33,58,.08);
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap: calc(10px * var(--fit));
      flex: 0 0 auto;
    }
    .seal{
      flex:0 0 auto;
      width: calc(44px * var(--fit));
      height: calc(44px * var(--fit));
      border-radius: 999px;
      background: radial-gradient(circle at 30% 30%, #fff, var(--gold));
      display:grid;
      place-items:center;
      box-shadow: 0 10px 26px rgba(0,0,0,.16);
      font-weight: 900;
      font-size: calc(16px * var(--fit));
    }
    .cardHeader h1{
      margin:0;
      font-size: calc(22px * var(--fit));
      line-height: 1.12;
      letter-spacing: .2px;
      font-weight: 900;
    }

    .cardBody{
      position:relative;
      padding: calc(16px * var(--fit)) calc(18px * var(--fit)) calc(18px * var(--fit));
      flex: 1 1 auto;
      min-height: 0;
      display:flex;
      flex-direction:column;
      gap: calc(12px * var(--fit));
      overflow:hidden;
    }

    .textStack{
      display:flex;
      flex-direction:column;
      gap: calc(10px * var(--fit));
      padding-top: calc(2px * var(--fit));
      min-height: 0;
      flex: 1 1 auto;
    }

    .para{
      margin:0;
      font-size: calc(14px * var(--fit));
      line-height: calc(1.35 * var(--fit));
      opacity: 0;
      transform: translateY(8px);
      transition: opacity 420ms ease, transform 420ms ease;
    }
    .para.show{
      opacity: .92;
      transform: translateY(0);
    }

    /* Signature line with badgers */
    .signature{
      margin-top: calc(4px * var(--fit));
      font-size: calc(13px * var(--fit));
      font-weight: 700;
      opacity: 0;
      transform: translateY(8px);
      transition: opacity 420ms ease, transform 420ms ease;
      display:flex;
      align-items:center;
      gap: calc(8px * var(--fit));
      position: relative;
      overflow: hidden;
      padding-right: 2px;
      flex: 0 0 auto;
    }
    .signature.show{ opacity:.9; transform: translateY(0); }

    .sigText{ white-space: nowrap; }

    .badgersInline{
      display:inline-flex;
      gap: 2px;
      white-space: nowrap;
      transform: translateX(140px);
      opacity: 0;
      font-size: calc(16px * var(--fit));
    }

    @keyframes badgersIn{
      0%   { transform: translateX(140px); opacity: 0; }
      80%  { opacity: 1; }
      100% { transform: translateX(0); opacity: 1; }
    }
    .signature.runBadgers .badgersInline{
      animation: badgersIn 900ms cubic-bezier(.2,.9,.2,1) forwards;
    }

    .tapArea{
      position:absolute;
      inset:0;
      z-index: 20;
      cursor:pointer;
    }

    /* ---- STATES ---- */
    body.state-0 .door{ transform: rotateY(0deg); }
    body.state-0 .card{ opacity:0; transform: translateX(-18px) translateY(10px); }
    body.state-0 #confetti{ opacity:0; }

    body.state-1 .door,
    body.state-2 .door,
    body.state-3 .door,
    body.state-4 .door,
    body.state-5 .door,
    body.state-6 .door{ transform: rotateY(-82deg); }

    body.state-1 .card,
    body.state-2 .card,
    body.state-3 .card,
    body.state-4 .card,
    body.state-5 .card,
    body.state-6 .card{ opacity:1; transform: translateX(0) translateY(0); }

    body.state-6 #confetti{ opacity:1; }

    /* ---------- EXACT VOUCHER CSS FROM YOUR SNIPPET ---------- */
    .voucherTop{
      padding:16px 18px 12px;
      border-bottom:1px solid rgba(16,33,58,.08);
      display:flex;
      justify-content:space-between;
    }
    .voucherKicker{
      margin:0;
      font-size:12px;
      letter-spacing:.22em;
      opacity:.6;
      font-weight:700;
    }
    .voucherTitle{
      margin:4px 0 0;
      font-size:22px;
      font-weight:900;
    }
    .voucherSeal{
      width:44px;height:44px;
      border-radius:50%;
      background:radial-gradient(circle at 30% 30%,#fff,var(--gold));
      display:grid;place-items:center;
    }

    .voucherContent{
      padding:18px;
      padding-bottom:80px;
      display:flex;
      flex-direction:column;
      gap:14px;
    }
    .voucherMainTitle{
      font-size:24px;
      font-weight:900;
    }
    .voucherText{
      font-size:14px;
      line-height:1.4;
      opacity:.85;
    }
    .voucherIcons{
      display:flex;
      gap:12px;
    }
    .voucherIcon{
      width:50%;
      border-radius:16px;
      border:1px solid rgba(16,33,58,.12);
      padding:14px;
      text-align:center;
    }
    .voucherIconTitle{
      font-weight:700;
      margin-bottom:10px;
    }
    .iconBubble{
      width:46px;height:46px;
      border-radius:50%;
      background:radial-gradient(circle at 30% 30%,#fff,var(--gold));
      display:grid;place-items:center;
      margin:0 auto;
    }
    .voucherFootnote{
      text-align:center;
      font-size:13px;
      opacity:.8;
    }
    .voucherFootnote::before{
      content:"* ";
      font-weight:700;
    }

    .voucherFooterBar{
      position:absolute;
      left:0;right:0;bottom:0;
      height:64px;
      border-top:1px dashed rgba(16,33,58,.18);
      display:flex;
      align-items:center;
      justify-content:center;
    }
    .voucherFooter{
      font-size:13px;
      font-weight:700;
      opacity:.85;
    }

    @media (prefers-reduced-motion: reduce){
      .door, .card, .para, .signature, .badgersInline, .doorWrap::before, .twinkles, .cardInner { transition:none !important; animation:none !important; }
      canvas{ display:none; }
      .badgersInline{ transform: translateX(0) !important; opacity:1 !important; }
      .cardInner{ transform: none !important; }
    }
  </style>
</head>
<body class="state-0">
  <div class="stage">
    <div class="hint" id="hint">Tippe auf das <b>T√ºrchen 24</b>.</div>

    <canvas id="snow"></canvas>
    <canvas id="confetti"></canvas>
    <div class="twinkles" aria-hidden="true"></div>

    <div class="doorWrap" aria-label="Adventst√ºrchen 24">
      <div class="frame"></div>

      <div class="card" id="card" aria-hidden="true">
        <div class="cardInner" id="cardInner">
          <!-- FRONT -->
          <div class="cardFace cardFront" aria-label="Karte Vorderseite">
            <div class="cardHeader">
              <div><h1>Frohe Weihnachten ‚ù§Ô∏è</h1></div>
              <div class="seal">üéÅ</div>
            </div>

            <div class="cardBody" id="cardBody">
              <div class="textStack" id="textStack">
                <p class="para" id="p1">Ich wei√ü, wie anstrengend dein Alltag oft ist und dass dabei Erholung manchmal einfach zu kurz kommt.</p>
                <p class="para" id="p2">Deshalb schenke ich dir zwei √úbernachtungen im Schwarzwald, damit wir gemeinsam mal rauskommen und uns eine kleine Auszeit nehmen k√∂nnen.</p>
                <p class="para" id="p3">Wir k√∂nnen wandern gehen, die Gegend genie√üen und wenn wir Lust haben auch in die Therme oder in den Pool gehen und einfach entspannen.</p>
                <p class="para" id="p4">Einfach Zeit f√ºr uns und ein Wochenende zum Abschalten.</p>

                <div class="signature" id="sig">
                  <span class="sigText">Dein Chrislib√§r</span>
                  <span class="badgersInline" aria-hidden="true">ü¶°ü¶°</span>
                </div>
              </div>
            </div>
          </div>

          <!-- BACK (GUTSCHEIN) ‚úÖ exakt dein HTML-Snippet -->
          <div class="cardFace cardBack" aria-label="Gutschein R√ºckseite">
            <div class="voucherTop">
              <div>
                <p class="voucherKicker">GUTSCHEIN</p>
                <div class="voucherTitle">Schwarzwald Auszeit</div>
              </div>
              <div class="voucherSeal">üéÅ</div>
            </div>

            <div class="voucherContent">
              <div class="voucherMainTitle">2 √úbernachtungen</div>
              <div class="voucherText">
                Ein Wochenende im Schwarzwald zum Abschalten, du kannst dir den Ort und das Datum aussuchen.
              </div>

              <div class="voucherIcons">
                <div class="voucherIcon">
                  <div class="voucherIconTitle">Schwarzwald</div>
                  <div class="iconBubble">üå≤</div>
                </div>
                <div class="voucherIcon">
                  <div class="voucherIconTitle">Entspannung</div>
                  <div class="iconBubble">üßò</div>
                </div>
              </div>

              <div class="voucherFootnote">inkl. Thermenbesuch</div>
            </div>

            <div class="voucherFooterBar">
              <div class="voucherFooter">g√ºltig bis 31.12.2026</div>
            </div>
          </div>
        </div>
      </div>

      <div class="door" role="button" aria-label="T√ºrchen 24 √∂ffnen">
        <div class="num">24</div>
        <div class="tag">Tippen</div>
        <div class="knob"></div>
      </div>

      <div class="tapArea" id="tapArea" aria-hidden="true"></div>
    </div>
  </div>

  <script>
    // ---------- state machine ----------
    // 0 = closed
    // 1 = open (card visible)
    // 2..5 = reveal paragraphs
    // 6 = flip to voucher + confetti
    let state = 0;

    const hint = document.getElementById('hint');
    const card = document.getElementById('card');
    const tapArea = document.getElementById('tapArea');
    const wrap = document.querySelector('.doorWrap');

    const p1 = document.getElementById('p1');
    const p2 = document.getElementById('p2');
    const p3 = document.getElementById('p3');
    const p4 = document.getElementById('p4');
    const sig = document.getElementById('sig');

    const cardBody = document.getElementById('cardBody');

    function setHint(){
      const h = [
        'Tippe auf das <b>T√ºrchen 24</b>.',
        'Tippe weiter.',
        'Tippe weiter.',
        'Tippe weiter.',
        'Tippe weiter.',
        'Noch ein Tipp.',
        'Fertig üéâ (Tippe, um neu zu starten.)'
      ];
      hint.innerHTML = h[state] || h[0];
    }

    function applyTextVisibility(){
      p1.classList.toggle('show', state >= 2);
      p2.classList.toggle('show', state >= 3);
      p3.classList.toggle('show', state >= 4);
      p4.classList.toggle('show', state >= 5);
      sig.classList.toggle('show', state >= 5);
    }

    // Dynamic fit for front
    function fitCardText(){
      if (state === 0) return;

      const root = document.documentElement;
      let fit = 1.0;
      root.style.setProperty('--fit', fit);

      const minFit = 0.80;
      const step = 0.02;

      requestAnimationFrame(() => {
        let guard = 0;
        while (cardBody.scrollHeight > cardBody.clientHeight + 1 && fit > minFit && guard < 60){
          fit = Math.max(minFit, +(fit - step).toFixed(2));
          root.style.setProperty('--fit', fit);
          guard++;
        }
      });
    }

    function setState(s){
      state = s;
      document.body.className = `state-${state}`;
      setHint();
      card.setAttribute('aria-hidden', state === 0 ? 'true' : 'false');

      sig.classList.remove('runBadgers');
      if (state === 5) requestAnimationFrame(() => sig.classList.add('runBadgers'));

      if (state === 6) startConfettiBurst();

      applyTextVisibility();
      fitCardText();
    }

    function tapBounce(){
      wrap.classList.add('tapPop');
      setTimeout(()=>wrap.classList.remove('tapPop'), 90);
    }

    function next(){
      tapBounce();
      if (state < 6) setState(state + 1);
      else setState(0);
    }
    tapArea.addEventListener('click', next);
    window.addEventListener('resize', () => fitCardText(), {passive:true});

    // ---------- snow ----------
    const snow = document.getElementById('snow');
    const sctx = snow.getContext('2d');
    let sw=0, sh=0, flakes=[];
    function resizeSnow(){
      sw = snow.width = Math.floor(window.innerWidth * devicePixelRatio);
      sh = snow.height = Math.floor(window.innerHeight * devicePixelRatio);
      flakes = Array.from({length: 110}, () => ({
        x: Math.random()*sw,
        y: Math.random()*sh,
        r: (Math.random()*1.9 + 0.6) * devicePixelRatio,
        v: (Math.random()*0.7 + 0.25) * devicePixelRatio,
        d: (Math.random()*0.8 - 0.4) * devicePixelRatio
      }));
    }
    window.addEventListener('resize', resizeSnow, {passive:true});
    resizeSnow();
    function drawSnow(){
      sctx.clearRect(0,0,sw,sh);
      sctx.globalAlpha = 0.9;
      for(const f of flakes){
        sctx.beginPath();
        sctx.arc(f.x, f.y, f.r, 0, Math.PI*2);
        sctx.fillStyle = 'rgba(255,255,255,.9)';
        sctx.fill();
        f.y += f.v;
        f.x += f.d;
        if (f.y > sh + 10) { f.y = -10; f.x = Math.random()*sw; }
        if (f.x > sw + 10) f.x = -10;
        if (f.x < -10) f.x = sw + 10;
      }
      requestAnimationFrame(drawSnow);
    }
    drawSnow();

    // ---------- confetti (burst) ----------
    const confettiCanvas = document.getElementById('confetti');
    const cctx = confettiCanvas.getContext('2d');
    let cw=0, ch=0;
    let confettiPieces = [];
    let confettiActive = false;

    function resizeConfetti(){
      cw = confettiCanvas.width = Math.floor(window.innerWidth * devicePixelRatio);
      ch = confettiCanvas.height = Math.floor(window.innerHeight * devicePixelRatio);
    }
    window.addEventListener('resize', resizeConfetti, {passive:true});
    resizeConfetti();

    function rand(min,max){ return min + Math.random()*(max-min); }

    function startConfettiBurst(){
      confettiPieces = Array.from({length: 140}, () => ({
        x: rand(0, cw),
        y: rand(-ch*0.15, 0),
        w: rand(6, 12) * devicePixelRatio,
        h: rand(4, 9) * devicePixelRatio,
        vx: rand(-2.0, 2.0) * devicePixelRatio,
        vy: rand(2.4, 5.8) * devicePixelRatio,
        rot: rand(0, Math.PI*2),
        vr: rand(-0.12, 0.12),
        life: rand(60, 110)
      }));
      confettiActive = true;
      setTimeout(() => { confettiActive = false; }, 2000);
    }

    function drawConfetti(){
      cctx.clearRect(0,0,cw,ch);
      if (confettiActive){
        for (const p of confettiPieces){
          const hue = (p.x / cw) * 360;
          cctx.save();
          cctx.translate(p.x, p.y);
          cctx.rotate(p.rot);
          cctx.fillStyle = `hsla(${hue}, 85%, 65%, 0.95)`;
          cctx.fillRect(-p.w/2, -p.h/2, p.w, p.h);
          cctx.restore();

          p.x += p.vx;
          p.y += p.vy;
          p.rot += p.vr;
          p.vy += 0.035 * devicePixelRatio;
          p.life -= 1;
        }
      }
      requestAnimationFrame(drawConfetti);
    }
    drawConfetti();

    setState(0);
  </script>
</body>
</html>
